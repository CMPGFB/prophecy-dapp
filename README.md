# Prediction Market Smart Contract

**Author:** Christopher Perceptions  
**Powered by:** NoCodeClarity v2

## Overview

The Prediction Market Smart Contract enables users to create prediction markets, place bets, resolve markets, and claim rewards. It is designed to operate on the Stacks blockchain and uses Clarity smart contracts to ensure transparency and security in market operations.

## Constants

- `contract-owner`: The principal of the contract owner (creator).
- Error codes:
  - `err-owner-only`: Error for unauthorized actions by non-owners.
  - `err-not-found`: Error when the market is not found.
  - `err-already-resolved`: Error when trying to resolve an already resolved market.
  - `err-market-not-resolved`: Error when trying to claim rewards from an unresolved market.
  - `err-no-reward`: Error when there is no reward to claim.
  - `err-already-participated`: Error when the user has already participated in the market.
  - `err-transfer-failed`: Error when transferring STX fails.
  - `err-invalid-question`: Error for invalid question length.
  - `err-invalid-amount`: Error for invalid prediction amount.
- `platform-fee`: The fee charged by the platform (0.01 STX = 10000 uSTX).

## Data Variables

- `market-nonce`: A unique identifier for each market.
- `platform-balance`: The total balance of the platform fees collected.

## Maps

- `markets`: Stores market information including question, creator, amounts for "yes" and "no" predictions, resolution status, and outcome.
- `market-balances`: Tracks user balances for each market, including amounts bet on "yes" and "no" predictions and whether the reward has been claimed.

## Public Functions

### `create-market`

Creates a new prediction market with a given question.

- **Parameters:**
  - `question (string-utf8 256)`: The question for the prediction market.
- **Returns:**
  - The unique `market-id` of the newly created market.

### `buy-prediction`

Allows users to place a bet on a prediction market.

- **Parameters:**
  - `market-id (uint)`: The ID of the market to bet on.
  - `amount (uint)`: The amount of STX to bet.
  - `prediction (bool)`: The prediction (true for "yes", false for "no").
- **Returns:**
  - Success status (`ok true`) or an error if the transaction fails.

### `resolve-market`

Resolves a prediction market with a given outcome.

- **Parameters:**
  - `market-id (uint)`: The ID of the market to resolve.
  - `outcome (bool)`: The outcome of the market (true for "yes", false for "no").
- **Returns:**
  - Success status (`ok true`) or an error if the resolution fails.

### `claim-reward`

Claims the reward for a user's bet if the market has been resolved.

- **Parameters:**
  - `market-id (uint)`: The ID of the market to claim the reward from.
- **Returns:**
  - The reward amount or an error if the claim fails.

### `withdraw-platform-fees`

Allows the contract owner to withdraw the collected platform fees.

- **Returns:**
  - The withdrawn amount or an error if the withdrawal fails.

## Read-only Functions

### `get-market`

Retrieves information about a specific market.

- **Parameters:**
  - `market-id (uint)`: The ID of the market to retrieve.
- **Returns:**
  - The market details or `null` if the market is not found.

### `get-balance`

Retrieves the balance of a user for a specific market.

- **Parameters:**
  - `market-id (uint)`: The ID of the market.
  - `user (principal)`: The user's principal address.
- **Returns:**
  - The user's balance details or `null` if not found.

### `get-platform-balance`

Retrieves the current platform balance.

- **Returns:**
  - The current platform balance.

## Notes

- Ensure that the contract owner address is correctly set for withdrawal operations.
- The platform fee is deducted from each transaction to cover platform costs.
- This is generated by NoCodeClarity and has NOT been formally audited.
- Use at your own risk. 

## License

- MIT 
